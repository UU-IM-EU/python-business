<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2019-05-01 12:48:12 -0500">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/syntax.css" />
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicon-swc.ico" />
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>Python for Business: Statistical Analysis and Visualization</title>
  </head>
  <body>
    <div class="container">
      
<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      

      
      <a class="navbar-brand" href="../">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../conduct/">Code of Conduct</a></li>

        
	
        <li><a href="../setup/">Setup</a></li>

        
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../00-intro_notebook/">Introduction to Jupyter Notebook</a></li>
            
            <li><a href="../01-intro/">Python basics 1 - Intro to Python</a></li>
            
            <li><a href="../02-conditional_loop/">Python basics 2 - Conditional statements and Loops</a></li>
            
            <li><a href="../03-func/">Python basics 3 - Functions and Modules</a></li>
            
            <li><a href="../04-pandas/">Intro to Pandas</a></li>
            
            <li><a href="../05-stat_vis/">Statistical Analysis and Visualization</a></li>
            
            <li><a href="../06-errors/">Extra - Errors and Exceptions</a></li>
            
            <li><a href="../07-debugging/">Extra - Debugging</a></li>
            
            <li><a href="../08-crisp/">Introduction to CRISP-DM</a></li>
            
            <li><a href="../09-data_prep/">Data Preparation techniques</a></li>
            
            <li><a href="../10-linear_regression/">Linear regression</a></li>
            
            <li><a href="../11-case_study/">Case Study</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio/">All in one page (Beta)</a></li>
          </ul>
        </li>
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference/">Reference</a></li>
            
            <li><a href="../about/">About</a></li>
            
            <li><a href="../discuss/">Discussion</a></li>
            
            <li><a href="../extras/figures.html">Figures</a></li>
            
            <li><a href="../guide/">Instructor Notes</a></li>
            
          </ul>
        </li>
	

	
        <li><a href="../LICENSE.html">License</a></li>
	
	<li><a href="/edit/gh-pages/_episodes/05-stat_vis.md">Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>


<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../04-pandas/"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
    <h3 class="maintitle"><a href="../">Python for Business</a></h3>
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../06-errors/"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">Statistical Analysis and Visualization</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 40 min
      <br/>
      <strong>Exercises:</strong> 0 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How can I perform statistical analysis in Python?</p>
</li>
	
	<li><p>How to visualize my data</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Learn to perform statistical analysis with Scipy.stats module</p>
</li>
	
	<li><p>Learn to visualize data with matplotlib</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="statistical-analysis-with-scipy">Statistical Analysis with Scipy</h2>
<p>Similar as the Dada Analytics Tools in Excel, python can perform many statistic analysis as well. <a href="https://www.scipy.org/"><code class="highlighter-rouge">scipy</code></a> module has many useful statistic tools. (more than Excel).</p>

<h3 id="t-test">t-test</h3>
<p>Assume you are interested in selling either energy drink or cola, and you want to know if the two categories has significant difference in average bottle sales.
We can perform a <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_ind.html">t-test</a> assuming different variance.<br />
Firstly we need to import the stats module.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
</code></pre></div></div>
<p>Then we need to use aggregate function to find the total bottle sold for each soda in each category. Remember the groupby function? Try to do it by yourself.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ct</span> <span class="o">=</span> <span class="n">inv_soda</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'Item_Description'</span><span class="p">,</span><span class="s">'Category'</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s">"Bottles_Sold"</span><span class="p">:</span><span class="s">"sum"</span><span class="p">})</span>
</code></pre></div></div>

<p>Then, you get the total bottles sold for the two categories.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ct_eng = ct[ct["Category"] == "Energy Drink"]
ct_cola = ct[ct["Category"] == "Cola"]
</code></pre></div></div>
<p>Finally, you perform the t-test.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>stats.ttest_ind(ct_eng['Bottles_Sold'],ct_cola['Bottles_Sold'], equal_var=False)
</code></pre></div></div>
<p>Then you get</p>
<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Ttest_indResult(statistic=1.9035249229837687, pvalue=0.057480903679786859)
</code></pre></div></div>
<p>Well, the p value is not low enough to reject the null.  <br /></p>

<h4 id="takeaways">Takeaways</h4>
<ul>
  <li>Scipy has a lot of statistical tools. You can perform anything in the Excel Data Analytics Tool with Scipy, yet it is much more powerful. For example, you can do <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.chisquare.html#scipy.stats.chisquare">chi-squares</a>, <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.f_oneway.html#scipy.stats.f_oneway">ANOVA</a>, <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.kstat.html#scipy.stats.kstat">k-stat</a>, etc. You can click the link to see all tools in <a href="https://docs.scipy.org/doc/scipy/reference/stats.html">Scipy.stats</a>.</li>
  <li>As you can observe above, the most difficult part is to preprocess the data. As soon as the data is prepaired, you can just feed it into the model, very easy.</li>
  <li>There are many modules that can perform stats tasks in python. For example, <a href="http://scikit-learn.org/stable/">sklearn</a>, <a href="https://www.statsmodels.org/stable/index.html">Statsmodles</a> are also great. You can play with those if you have time.</li>
</ul>

<h2 id="visualization">Visualization</h2>

<h3 id="basics">Basics</h3>
<p>Many of you are experts in Excel graphing. You can do similar visualization with python. <a href="https://matplotlib.org/"><code class="highlighter-rouge">matplotlib</code></a> is a good starter module for visualization in python. Firstly, let’s import the module.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="c1"># In majority of cases, you will just use pyplot. So you can just import that.   
</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</code></pre></div></div>
<p>Similar as Excel, you just need to feed in the values in x-axis and y-axis. Let’s start with a very basic example:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># create three points for the first line
</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="c1"># create three points for the second line (optional, I just want to show you that you can plot multiple lines in one graph)
</span><span class="n">x2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">3.5</span><span class="p">]</span>
<span class="n">y2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.7</span><span class="p">,</span><span class="mf">3.7</span><span class="p">,</span><span class="mf">5.7</span><span class="p">]</span>
<span class="c1"># change size (set size before plotting)
</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="c1"># plot the graph  
</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">"first line"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">"second line"</span><span class="p">)</span>
<span class="c1"># Set x, y limits  
</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="c1"># Add x, y label  
</span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"independent variable"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"dependent variable"</span><span class="p">)</span>
<span class="c1"># Add title
</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">"example"</span><span class="p">)</span>
<span class="c1"># Add legend  
</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="c1"># show the graph
</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p>You will get something like this:<br />
<img src="../pic/graph.png" alt="graph" height="400px" /></p>

<p>Without a graphic interface like Excel, it is a little less intuitive. Carefully review the code, and try to understand what each line is doing.  Note that <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html"><code class="highlighter-rouge">pyplot.plot</code></a> (you can click to read the documentation) has a lot of parameters. Basically, you can customize everything such as color, marker, alpha, etc.</p>

<h3 id="histogram">Histogram</h3>
<p>Let’s go back to our data.<br />
Assume you want to see the price distribution of the soda that cost less than $5, you can draw a histogram with <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.hist.html"><code class="highlighter-rouge">pyplot.hist</code></a>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># set size
</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="c1"># feed in the data, set range, plot the graph
</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">soda</span><span class="p">[</span><span class="s">'Bottle_Cost'</span><span class="p">],</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="c1"># set x, y label
</span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"price"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"number of soda"</span><span class="p">)</span>
<span class="c1"># Add title
</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Price distribution"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="../pic/hist.png" alt="hist" height="400px" /></p>

<p>This is a very basic example. You can customize a lot more parameters such as colors, bins, etc.</p>

<h3 id="scatter-plot">Scatter plot</h3>

<p>A scatter plot is a two-dimensional data visualization that uses dots to represent the values obtained for two different variables.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># set figure size  
</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="c1"># Plot data
</span><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">soda</span><span class="p">[</span><span class="s">'Bottle_Cost'</span><span class="p">],</span> <span class="n">soda</span><span class="p">[</span><span class="s">'Bottle_Retail_Price'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"Bottle_Cost"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Bottle_Retail_Price"</span><span class="p">)</span>
<span class="c1"># Set title  
</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Bottle_Retail_Price VS Bottle_Cost"</span><span class="p">)</span>
<span class="c1"># Set x, y limit  
</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="../pic/sc.png" alt="sc" height="400px" /></p>

<h4 id="takeaways-1">Takeaways</h4>
<ul>
  <li>You can do many other kinds of visualizations with matplotlib. For example, <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.pie.html">pie chart</a>, <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.bar.html">bar chart</a>, etc.</li>
  <li>Anything you can draw in Excel, you can do it with matplotlib. Similar as statistical analysis, the most difficult part for visualization is preprocessing. After that, you can just feed your data into the pre-written graphing tool.</li>
  <li>If you are going to big companies, you will probablly learn Tableau later. Tableau can easily create nice graphs but it is a little annoying in preprocessing. We can preprocess with python and feed the data to Tableau. <br /></li>
  <li>Last but not the least, there are many other cool visualization modules avaliable. If you have time, you can consider these modules: <a href="https://plot.ly/">plotly</a>, <a href="https://graph-tool.skewed.de">graph-tool</a>. They can draw cool and interactive graphs.</li>
</ul>

<blockquote class="challenge">
  <h2 id="challenge">Challenge</h2>
  <p>Assume you just opened a new convenience store. You want to see what categories of soda did other stores spend the most money on in their inventory. <br />
What are the top three categories in terms of total cost? Visualize it with pie chart. Read the <a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.pie.html">documentation</a> yourself and try to figure out how to draw it.
Hint: 1. Calculate total cost for each soda (arithmetic)</p>
  <ol>
    <li>Calculate total cost for each category (aggregation)</li>
    <li>Sort the aggregated value</li>
    <li>draw the graph (what is the x? what is the label?)</li>
    <li>set autopct parameter to ‘%.0f%%’</li>
  </ol>

  <blockquote class="solution">
    <h2 id="solution">Solution</h2>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>inv_soda["Total_Cost"] = inv_soda["Bottle_Cost"] * inv_soda["Bottles_Sold"]  
ct = inv_soda.groupby(['Category'])["Total_Cost"].agg(["sum"]).reset_index()
ct = temp.sort_values("sum", ascending = False)
plt.figure(figsize=(15,15))
plt.pie(ct["sum"], labels=ct["Category"], autopct='%.0f%%')
plt.show()

</code></pre></div>    </div>
  </blockquote>
</blockquote>


<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Use <code class="highlighter-rouge">scipy.stats.ttest_ind</code> for t-test</p>
</li>
    
    <li><p>There are many other statistical tools in scipy, you can read the documentation for more details</p>
</li>
    
    <li><p>You can customize many parameters in your graph, you can read the documentation for more details</p>
</li>
    
    <li><p>For both Scipy and matplotlib, the most difficult part is to preprocess your data. After that, you can just find the right function and feed your data into it.</p>
</li>
    
  </ul>
</blockquote>

</article>

<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../04-pandas/"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../06-errors/"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      
<footer>
  <div class="row">
    <div class="col-md-6" align="left">
      <h4>
	Copyright &copy; 2016–2019
	
	<a href="https://software-carpentry.org">Software Carpentry Foundation</a>
	
      </h4>
    </div>
    <div class="col-md-6" align="right">
      <h4>
	
	<a href="/edit/gh-pages/_episodes/05-stat_vis.md">Edit on GitHub</a>
	
	/
	<a href="/blob/gh-pages/CONTRIBUTING.md">Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob/gh-pages/CITATION">Cite</a>
	/
	<a href="lessons@software-carpentry.org">Contact</a>
      </h4>
    </div>
  </div>
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
